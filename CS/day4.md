## 프로세스

- 컴퓨터에서 실행되고 있는 프로그램
- 프로세스 구조
  - 코드 영역: 실행 파일 내 명령어들이 위치하는 공간
  - 데이터 영역: 전역 / 정적 변수들이 위치하는 공간
  - 힙(heap) 영역: 동적 할당을 위한 메모리 영역
  - 스택(stack) 영역: 지역 변수, 파라미터가 위치하는 공간
- 프로세스 상태
  - 생성(new)
    - 프로새스가 생성된 상태
    - OS 커널의 Ready Queue 에 올라가면 준비(ready) 상태로 변함
  - 준비(ready)
    - 프로세스가 CPU로부터 메모리 공간을 할당받기 기다리는 상태
    - 프로세스 스케줄러에 의해 할당받게 되면 실행(running) 상태로 변함. 이를 dispatch 라고 함
  - 실행(running)
    - 명령어들이 실행되고 있는 상태
    - interrupt가 발생하면 준비(ready) 상태로 변함
    - 실행을 마치면 종료(terminated) 상태로 변함
    - 입출력이나 이벤트가 발생하면 대기(waiting) 상태로 변함
  - 대기(waiting)
    - 입출력 또는 특정 이벤트가 발생하길 기다리는 상태
    - 입출력 또는 특정 이벤트가 완료되면 ready 상태로 변함
  - 종료(terminated)
    - 프로세스가 실행을 끝마친 상태

### 프로세스 스케줄링

- CPU 할당 순서 및 방법을 결정하는 과정
- 스케줄링 기법
  - 선점형 스케줄링
    - 우선순위가 높은 프로세스가 현재 프로세스를 중단시키고 CPU를 점유
    - 응답이 빠르지만 처리시간을 예측하기 힘듬
    - 높은 우선순위 프로세스가 계속 들어온다면 오버헤드 발생
    - 실시간 응답 환경과 같은 우선순위가 높은 프로세스를 빠르게 처리할 때 용이
    - 대표적 알고리즘 → 라운드 로빈(RR), 다단계 큐, 다단계 피드백 큐 등
  - 비선점형 스케줄링
    - 한 프로세스가 CPU를 할당받으면 작업 종료 후 CPU 반환 시까지 다른 프로세스가 CPU 점유를 하지 못함
    - 짧은 작업을 수행하는 프로세스가 긴 작업 프로세스가 완료될 때까지 기다려야 하는 단점 발생
    - 처리시간 편차가 짧은 프로세스 처리에 용이
    - 대표적 알고리즘 → 우선순위, SJF(Short Job First), FIFO(First In First Out) 등

## 스레드(Thread)

- 프로세스 내에서 실행되는 흐름의 단위또는 CPU 스케줄링의 기본 단위
- 프로세스 내에서 실제 작업을 실행하는 주체
- 모든 프로세스에는 하나 이상의 스레드 존재특징
  - 가가 자신의 Stack 영역 보유
  - 스레드는 프로세스 내에서 코드, 데이터, 힙 영역 공유
  - 스레드 생성, 변경에는 큰 비용이 들지 않음
- 멀티 스레드
  - 한 프로세스가 여러 스레드로 동시에 여러 작업을 수행
  - 장점
    - 응답성 향상: 실시간으로 사용자에게 응답 가능
    - 자원 공유: 자신이 속한 프로세스 내 스레드들과 자원 공유 가능
    - 경제성: 프로세스 생성보다 스레드 생성이 경제적
    - 확장성: 한 프로세스를 여러 프로세서에서 수행 가능

### 스레드 유형

- 커널 수준 스레드
  - 1대1 매핑 방식
  - 스레드를 커널(OS)가 직접 관리(생성, 스케줄링 등)
  - 장점
    - 커널이 각 스레드를 개별적 관리
    - 프로세스 내 스레드들이 병행 수행 가능
    - 하나의 스레드가 block 되어도 다른 스레드는 계속 작업 가능
  - 단점
    - context switching으로 인한 오버헤드가 큼
    - 사용자 스레드보다 생성 및 관리 속도 느림
- 사용자 수준 스레드
  - N대1 매핑 방식
  - 사용자 영역의 스레드 라이브러리로 구현
  - 라이브러리는 스레드의 생성, 스케줄링 담당
  - 커널이 스레드의 존재를 인식하지 못하기 때문에 커널의 개입을 받지 않음
  - 장점
    - 커널의 개입을 받지 않아 스레드의 생성 및 관리의 부하 적음
    - 동일한 메모리 영역에서 스레드가 생성 및 관리되어 빠른 속도
    - 라이브러리를 통한 이식성 높음
  - 단점
    - 커널은 프로세스 단위로 자원 할당, 이에 따라 하나의 스레드가 block된다면 모든 스레드가 대기
- 혼합 스레드
  - N:M 매핑 방식
  - 사용자 수준 스레드와 커널 수준 스레드를 혼합
  - 장점
    - 프로세스 내 스레드들이 병행 수행 가능
    - 사용자는 원하는 수만큼 스레드 사용
    - 효율적, 유연함
    - 스레드 풀링 기법을 통해 일대일 스레드 매핑에서 오버헤드를 줄여줌
  - 스레드 풀링
    - 시스템이 관리하는 스레드의 풀을 응용프로그램에 제공하여 스레드를 효율적으로 사용할 수 있는 방법
    - 미리 생성한 스레드를 재사용하여 시스템의 부하를 덜어줌
    - 동시 생성 가능한 스레드 수를 제한시켜 시스템 자원 소비를 줄임 → 프로그램 전체 성능을 일정 수준 유지

## 스레드와 프로세스의 차이

|  | 프로세스 | 스레드 |
| --- | --- | --- |
| 통신 | 프로세스 간 통신에 IPC 필요 | 스레드 간 통신에 IPC 필요 x |
| 영역 공유 | Code, Data, Heap, Stack 영역 각자 보유 | Code, Data, Heap 영역 공유, Stack 영역 각자 보유 |
| 생성, Context switching 비용 | 많은 비용 | 적은 비용 |
| 독립성 | 다른 프로세스에 영향을 미치지 않음 | 다른 스레드에 영향을 미칠 수 있음 |